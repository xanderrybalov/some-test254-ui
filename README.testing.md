# Testing Guide

## üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–∫

- **Vitest** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π test runner –¥–ª—è Vite –ø—Ä–æ–µ–∫—Ç–æ–≤
- **React Testing Library** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **jsdom** - —ç–º—É–ª—è—Ü–∏—è DOM –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **Custom Test Utilities** - –≥–æ—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å Redux –∏ Router

## üèÉ‚Äç‚ôÇÔ∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
npm test

# –ó–∞–ø—É—Å–∫ –≤ watch —Ä–µ–∂–∏–º–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)
npm run test:watch

# –ó–∞–ø—É—Å–∫ –æ–¥–∏–Ω —Ä–∞–∑
npm run test:run

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
npm run test:coverage

# –ó–∞–ø—É—Å–∫ UI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º)
npm run test:ui
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
src/
‚îú‚îÄ‚îÄ __tests__/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ components/__tests__/ # –¢–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ store/__tests__/     # –¢–µ—Å—Ç—ã Redux slices
‚îú‚îÄ‚îÄ utils/__tests__/     # –¢–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç
‚îî‚îÄ‚îÄ test/               # –¢–µ—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    ‚îú‚îÄ‚îÄ setup.ts        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    ‚îî‚îÄ‚îÄ utils.tsx       # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```

## üéØ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### Redux Slices
- ‚úÖ **userMovieSlice** - —Å–æ–∑–¥–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∏–ª—å–º–æ–≤
- ‚úÖ **favoritesSlice** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å–º–∞–º–∏, –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- ‚úÖ **Async thunks** - API –∑–∞–ø—Ä–æ—Å—ã, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ **Reducers** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ **MovieList** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏/–æ—à–∏–±–∫–∏
- ‚úÖ **AddMovieModal** - —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å–º–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- ‚úÖ **User interactions** - –∫–ª–∏–∫–∏, –Ω–∞–≤–µ–¥–µ–Ω–∏—è, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º

### API –£—Ç–∏–ª–∏—Ç—ã
- ‚úÖ **ApiService** - HTTP –º–µ—Ç–æ–¥—ã (GET, POST, PUT, DELETE)
- ‚úÖ **Authentication** - –≤–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **Error handling** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –∏ –æ—à–∏–±–æ–∫ API

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ **–ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏** - –æ—Ç –ø–æ–∏—Å–∫–∞ –¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ª–æ–≥–∏–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** - –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## üîß –ö–∞—Å—Ç–æ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

### `renderWithProviders()`
–ì–æ—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å Redux, Router –∏ Theme –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏:

```tsx
import { renderWithProviders, mockUser } from '../test/utils'

test('should render with authentication', () => {
  const preloadedState = {
    auth: { isAuthenticated: true, user: mockUser }
  }
  
  renderWithProviders(<MyComponent />, { preloadedState })
})
```

### –ú–æ–∫ –¥–∞–Ω–Ω—ã–µ
- `mockMovie` - —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∏–ª—å–º –∏–∑ OMDB
- `mockUserMovie` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–ª—å–º  
- `mockUser` - —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

## üé® Best Practices

1. **–¢–µ—Å—Ç–∏—Ä—É–π –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é** - —Ñ–æ–∫—É—Å –Ω–∞ —Ç–æ–º, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. **–ò—Å–ø–æ–ª—å–∑—É–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** - `getByRole`, `getByLabelText` –≤–º–µ—Å—Ç–æ className
3. **–ú–æ–∫–∏—Ä—É–π –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - API, localStorage, browser APIs
4. **–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω** - `beforeEach` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
5. **–û—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤** - –æ–ø–∏—Å—ã–≤–∞–π –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

## üöÄ –ü—Ä–∏–º–µ—Ä—ã

### –¢–µ—Å—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
```tsx
it('should render movies when available', () => {
  const preloadedState = {
    movies: { movies: [mockMovie], loading: false }
  }
  
  renderWithProviders(<MovieList />, { preloadedState })
  expect(screen.getByText(mockMovie.title)).toBeInTheDocument()
})
```

### –¢–µ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
```tsx
it('should close modal when cancel is clicked', async () => {
  const user = userEvent.setup()
  const onClose = vi.fn()
  
  renderWithProviders(<AddMovieModal visible onClose={onClose} />)
  await user.click(screen.getByText('Cancel'))
  
  expect(onClose).toHaveBeenCalled()
})
```

### –¢–µ—Å—Ç Redux slice
```tsx
it('should handle addMovie.fulfilled', () => {
  const action = { type: addUserMovie.fulfilled.type, payload: mockMovie }
  const state = userMovieReducer(initialState, action)
  
  expect(state.userMovies).toContain(mockMovie)
  expect(state.loading).toBe(false)
})
```

## üìä Coverage

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏  
- API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –∫–æ–¥–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `npm run test:coverage`.
